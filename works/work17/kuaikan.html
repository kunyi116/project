<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/kuankan.css">
    <title>Document</title>
</head>
<body>
    <div class="serch">
        <img class="logo" src="https://static3w.kuaikanmanhua.com/_nuxt/static-kkfront-mobile/image/logo.9fb4c38.png" alt="">
        <a href="">
            <img src="https://static3w.kuaikanmanhua.com/_nuxt/static-kkfront-mobile/image/search_icon.8cb94f3.png" alt="">
            <span>搜索作者名</span>
        </a>
        <div class="sj">
            <img src="https://static3w.kuaikanmanhua.com/_nuxt/static-kkfront-mobile/image/booklist_icon.40fddad.png" alt="">
            <span>书架</span>
        </div>
    </div>
    <ul class="nav">
        <li><span>发现</span></li>
        <li><span>推荐</span></li>
        <li><span>世界</span></li>
    </ul>
    <div class="carousel-container">
        <div class="carousel-slides">
            <div class="slide" style="background-image: url('https://f2.kkmh.com/image/240726/WtByuYdqH.png-t.w720.webp.h');"></div>
            <div class="slide" style="background-image: url('https://f2.kkmh.com/image/240823/5Zvr5Ccbe.png-t.w720.webp.h');"></div>
            <div class="slide" style="background-image: url('https://f2.kkmh.com/image/240823/N2rw4GGYb.jpg-t.w720.webp.h');"></div>
            <div class="slide" style="background-image: url('https://f2.kkmh.com/image/240621/yw4vkDoRI.jpg-t.w720.webp.h');"></div>
            <div class="slide" style="background-image: url('https://f2.kkmh.com/image/240823/y0IQlDkVv.png-t.w720.webp.h');"></div>
        </div>
        <div class="carousel-indicators">
            <span class="indicator active"></span>
            <span class="indicator"></span>
            <span class="indicator"></span>
            <span class="indicator"></span>
            <span class="indicator"></span>
        </div>
    </div>
    <ul class="entry">
        <li>
            <img class="type" src="https://f2.kkmh.com/image/211202/Afymd48ND.png" alt="">
            <p>作品分类</p>
            <img class="jiantou" src="https://f2.kkmh.com/cbb/comic/mini/mini_discovery_arrow.png" alt="">
        </li>
        <li>
            <img class="type" src="https://f2.kkmh.com/image/230726/p6qn74iTm.png" alt="">
            <p>会员享8.5折</p>
            <img class="jiantou" src="https://f2.kkmh.com/cbb/comic/mini/mini_discovery_arrow.png" alt="">
        </li>
    </ul>
    <div class="reco">
        <h3 class="title">
            为你推荐
        </h3>
        <ul class="reco-lists">
            <li>
                <img src="https://hs1-f2.v3mh.com/image/231110/iv8AcsGT9.webp-t.w320.webp.h" alt="">
                <p class="p1">我就想蹭你的气运</p>
                <p class="p2">重生 逆袭 青春</p>
                <span class="guanzhu">125万关注</span>
            </li>
            <li>
                <img src="https://hs1-f2.v3mh.com/image/231110/iv8AcsGT9.webp-t.w320.webp.h" alt="">
                <p class="p1">我就想蹭你的气运</p>
                <p class="p2">重生 逆袭 青春</p>
                <span class="guanzhu">125万关注</span>
            </li>
            <li>
                <img src="https://hs1-f2.v3mh.com/image/231110/iv8AcsGT9.webp-t.w320.webp.h" alt="">
                <p class="p1">我就想蹭你的气运</p>
                <p class="p2">重生 逆袭 青春</p>
                <span class="guanzhu">125万关注</span>
            </li>
            <li>
                <img src="https://hs1-f2.v3mh.com/image/231110/iv8AcsGT9.webp-t.w320.webp.h" alt="">
                <p class="p1">我就想蹭你的气运</p>
                <p class="p2">重生 逆袭 青春</p>
                <span class="guanzhu">125万关注</span>
            </li>
            <li>
                <img src="https://hs1-f2.v3mh.com/image/231110/iv8AcsGT9.webp-t.w320.webp.h" alt="">
                <p class="p1">我就想蹭你的气运</p>
                <p class="p2">重生 逆袭 青春</p>
                <span class="guanzhu">125万关注</span>
            </li>
            <li>
                <img src="https://hs1-f2.v3mh.com/image/231110/iv8AcsGT9.webp-t.w320.webp.h" alt="">
                <p class="p1">我就想蹭你的气运</p>
                <p class="p2">重生 逆袭 青春</p>
                <span class="guanzhu">125万关注</span>
            </li>
        </ul>
    </div>
    <div class="btn-box">
        <div class="more">
            <span>查看更多</span>
        </div>
        <div class="change">
            <span>换一换</span>
        </div>
    </div>
    <div class="bottom-box">
        <div class="bottom-content">
            <img class="close" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAHlBMVEUAAACfn5+cnJybm5uampqampqampqZmZmampqZmZlm8TDGAAAACXRSTlMACENXg6v8/f12BRgcAAAAnUlEQVQ4y2NgGAmA0VUBwWEKEYCzWWYmIyTMZjrA2awzpxnA2MyZMwMQujMRWsxmTlNA1g7TwpyJbCwS1wzJVGQ+mgaEALoGmAiGBpgQpgaIGBYNEC3YNIC0zKjEogGsBasGBgaLmTOLsQa++cyZzQykGGU2c3onNstxOheXB3EGCa5AxBnsuCIKZ9TiSgw4kw/OBIczieJM1MMZAAB+x08p/mLdxAAAAABJRU5ErkJggg==" alt="">
            <img class="bottom-img" src="https://static3w.kuaikanmanhua.com/_nuxt/static-kkfront-mobile/image/logo.9fb4c38.png" alt="">
            <div class="text">
                <p class="bottom-title">快看漫画APP</p>
                <p class="bottom-intro">快看！你的漫画乐园</p>
            </div>
            <div class="opennow">
                <span>立即打开</span>
            </div>
        </div>
        <div class="bottom-content">
            <img class="close" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAHlBMVEUAAACfn5+cnJybm5uampqampqampqZmZmampqZmZlm8TDGAAAACXRSTlMACENXg6v8/f12BRgcAAAAnUlEQVQ4y2NgGAmA0VUBwWEKEYCzWWYmIyTMZjrA2awzpxnA2MyZMwMQujMRWsxmTlNA1g7TwpyJbCwS1wzJVGQ+mgaEALoGmAiGBpgQpgaIGBYNEC3YNIC0zKjEogGsBasGBgaLmTOLsQa++cyZzQykGGU2c3onNstxOheXB3EGCa5AxBnsuCIKZ9TiSgw4kw/OBIczieJM1MMZAAB+x08p/mLdxAAAAABJRU5ErkJggg==" alt="">
            <img class="bottom-img" src="https://static3w.kuaikanmanhua.com/_nuxt/static-kkfront-mobile/image/ttcbz.d06247d.png" alt="">
            <div class="text">
                <p class="bottom-title">《偷偷藏不住》独家上线</p>
                <p class="bottom-intro">去爱一个人，不顾所有>></p>
            </div>
            <div class="opennow">
                <span>立即打开</span>
            </div>
        </div>
        <div class="bottom-content">
            <img class="close" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAHlBMVEUAAACfn5+cnJybm5uampqampqampqZmZmampqZmZlm8TDGAAAACXRSTlMACENXg6v8/f12BRgcAAAAnUlEQVQ4y2NgGAmA0VUBwWEKEYCzWWYmIyTMZjrA2awzpxnA2MyZMwMQujMRWsxmTlNA1g7TwpyJbCwS1wzJVGQ+mgaEALoGmAiGBpgQpgaIGBYNEC3YNIC0zKjEogGsBasGBgaLmTOLsQa++cyZzQykGGU2c3onNstxOheXB3EGCa5AxBnsuCIKZ9TiSgw4kw/OBIczieJM1MMZAAB+x08p/mLdxAAAAABJRU5ErkJggg==" alt="">
            <img class="bottom-img" src="https://static3w.kuaikanmanhua.com/_nuxt/static-kkfront-mobile/image/zdyn.6475c24.png" alt="">
            <div class="text">
                <p class="bottom-title">《再度与你》</p>
                <p class="bottom-intro">晗旭L-Mo新作，独家呈现>></p>
            </div>
            <div class="opennow">
                <span>立即打开</span>
            </div>
        </div>
        <div class="bottom-content">
            <img class="close" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAHlBMVEUAAACfn5+cnJybm5uampqampqampqZmZmampqZmZlm8TDGAAAACXRSTlMACENXg6v8/f12BRgcAAAAnUlEQVQ4y2NgGAmA0VUBwWEKEYCzWWYmIyTMZjrA2awzpxnA2MyZMwMQujMRWsxmTlNA1g7TwpyJbCwS1wzJVGQ+mgaEALoGmAiGBpgQpgaIGBYNEC3YNIC0zKjEogGsBasGBgaLmTOLsQa++cyZzQykGGU2c3onNstxOheXB3EGCa5AxBnsuCIKZ9TiSgw4kw/OBIczieJM1MMZAAB+x08p/mLdxAAAAABJRU5ErkJggg==" alt="">
            <img class="bottom-img" src="https://static3w.kuaikanmanhua.com/_nuxt/static-kkfront-mobile/image/wtmdfp.d990535.png" alt="">
            <div class="text">
                <p class="bottom-title">《我！天命大反派》</p>
                <p class="bottom-intro">一朝穿越玄幻界，上天要我做反派！</p>
            </div>
            <div class="opennow">
                <span>立即打开</span>
            </div>
        </div>
        <div class="bottom-content">
            <img class="close" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAHlBMVEUAAACfn5+cnJybm5uampqampqampqZmZmampqZmZlm8TDGAAAACXRSTlMACENXg6v8/f12BRgcAAAAnUlEQVQ4y2NgGAmA0VUBwWEKEYCzWWYmIyTMZjrA2awzpxnA2MyZMwMQujMRWsxmTlNA1g7TwpyJbCwS1wzJVGQ+mgaEALoGmAiGBpgQpgaIGBYNEC3YNIC0zKjEogGsBasGBgaLmTOLsQa++cyZzQykGGU2c3onNstxOheXB3EGCa5AxBnsuCIKZ9TiSgw4kw/OBIczieJM1MMZAAB+x08p/mLdxAAAAABJRU5ErkJggg==" alt="">
            <img class="bottom-img" src="https://static3w.kuaikanmanhua.com/_nuxt/static-kkfront-mobile/image/logo.9fb4c38.png" alt="">
            <div class="text">
                <p class="bottom-title">快看漫画APP</p>
                <p class="bottom-intro">快看！你的漫画乐园</p>
            </div>
            <div class="opennow">
                <span>立即打开</span>
            </div>
        </div>
    </div>
    <script src="./js/reset.js"></script>
    <script>
(function(doc, win) {
    // 根元素大小计算
    var docEl = doc.documentElement,
        resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize';
    
    function recalc() {
        var clientWidth = docEl.clientWidth;
        if (!clientWidth) return;
        docEl.style.fontSize = 40 * (clientWidth / 750) + 'px';
    }

    // 轮播图功能
    function Carousel() {
        // 元素引用
        this.container = document.querySelector('.carousel-container');
        this.slidesContainer = document.querySelector('.carousel-slides');
        this.slides = document.querySelectorAll('.slide');
        this.indicators = document.querySelectorAll('.indicator');
        
        // 状态变量
        this.slideCount = this.slides.length;
        this.currentIndex = 0;
        this.autoPlayInterval = null;
        this.isDragging = false;
        this.startX = 0;
        this.currentX = 0;
        this.isAnimating = false;
        
        // 初始化
        this.init = function() {
            // 克隆第一张和最后一张幻灯片
            var firstClone = this.slides[0].cloneNode(true);
            var lastClone = this.slides[this.slideCount-1].cloneNode(true);
            this.slidesContainer.insertBefore(lastClone, this.slides[0]);
            this.slidesContainer.appendChild(firstClone);
            
            // 更新slides引用
            this.slides = document.querySelectorAll('.slide');
            
            this.updateLayout();
            // 初始位置设为1（因为前面加了克隆的最后一张）
            this.currentIndex = 1;
            this.updatePosition();
            this.startAutoPlay();
            this.addEventListeners();
        };
        
        // 更新布局
        this.updateLayout = function() {
            var remInPx = parseFloat(getComputedStyle(document.documentElement).fontSize);
            this.slideWidth = 17.95 * remInPx; // 359px / 20 = 17.95rem
            
            // 增加两个slide的宽度用于克隆元素
            this.slidesContainer.style.width = `${(this.slideCount + 2) * this.slideWidth}px`;
            
            for (var i = 0; i < this.slides.length; i++) {
                this.slides[i].style.width = `${this.slideWidth}px`;
            }
        };
        
        // 更新位置
        this.updatePosition = function() {
            if (this.isAnimating) return;
            
            this.slidesContainer.style.transition = 'transform 0.3s ease-out';
            this.slidesContainer.style.transform = `translateX(${-this.currentIndex * this.slideWidth}px)`;
            this.updateIndicators();
        };
        
        // 无缝切换到另一端
        this.seamlessReset = function(isForward) {
            this.isAnimating = true;
            
            // 禁用过渡效果
            this.slidesContainer.style.transition = 'none';
            
            if(isForward) {
                // 从最后一张切换到第一张
                this.currentIndex = 1;
            } else {
                // 从第一张切换到最后一张
                this.currentIndex = this.slideCount;
            }
            
            this.slidesContainer.style.transform = `translateX(${-this.currentIndex * this.slideWidth}px)`;
            
            // 强制重绘
            this.slidesContainer.offsetHeight;
            
            // 恢复过渡效果
            this.slidesContainer.style.transition = 'transform 0.3s ease-out';
            this.isAnimating = false;
            this.updateIndicators();
        };
        
        // 更新指示器
        this.updateIndicators = function() {
            // 计算真实索引（减去前面的克隆）
            var realIndex = (this.currentIndex - 1) % this.slideCount;
            realIndex = realIndex < 0 ? this.slideCount - 1 : realIndex;
            
            for (var i = 0; i < this.indicators.length; i++) {
                this.indicators[i].classList.toggle('active', i === realIndex);
            }
        };
        
        // 下一张幻灯片
        this.nextSlide = function() {
            if (this.isAnimating) return;
            
            this.currentIndex++;
            
            if (this.currentIndex === this.slideCount + 1) {
                // 正常滑动到克隆的第一张
                this.updatePosition();
                
                // 滑动完成后立即无动画重置
                setTimeout(() => this.seamlessReset(true), 300);
            } else {
                this.updatePosition();
            }
        };
        
        // 上一张幻灯片
        this.prevSlide = function() {
            if (this.isAnimating) return;
            
            this.currentIndex--;
            
            if (this.currentIndex === 0) {
                // 正常滑动到克隆的最后一张
                this.updatePosition();
                
                // 滑动完成后立即无动画重置
                setTimeout(() => this.seamlessReset(false), 300);
            } else {
                this.updatePosition();
            }
        };
        
        // 开始自动播放
        this.startAutoPlay = function() {
            this.stopAutoPlay();
            this.autoPlayInterval = setInterval(this.nextSlide.bind(this), 1500);
        };
        
        // 停止自动播放
        this.stopAutoPlay = function() {
            if (this.autoPlayInterval) {
                clearInterval(this.autoPlayInterval);
            }
        };
        
        // 添加事件监听
        this.addEventListeners = function() {
            // 触摸事件
            this.container.addEventListener('touchstart', this.handleTouchStart.bind(this), { passive: false });
            this.container.addEventListener('touchmove', this.handleTouchMove.bind(this), { passive: false });
            this.container.addEventListener('touchend', this.handleTouchEnd.bind(this));
            
            // 指示器点击事件
            for (var i = 0; i < this.indicators.length; i++) {
                this.indicators[i].addEventListener('click', (function(index) {
                    return function() {
                        if (this.isAnimating) return;
                        this.currentIndex = index + 1; // +1因为前面有克隆的最后一张
                        this.updatePosition();
                        this.startAutoPlay();
                    }.bind(this);
                })(i).bind(this));
            }
            
            // 窗口大小变化事件
            win.addEventListener(resizeEvt, this.handleResize.bind(this));
        };
        
        // 触摸开始处理
        this.handleTouchStart = function(e) {
            this.stopAutoPlay();
            this.isDragging = true;
            this.startX = e.touches[0].clientX;
            this.currentX = this.startX;
            this.slidesContainer.style.transition = 'none';
        };
        
        // 触摸移动处理
        this.handleTouchMove = function(e) {
            if (!this.isDragging || this.isAnimating) return;
            e.preventDefault();
            
            var x = e.touches[0].clientX;
            var diff = x - this.currentX;
            this.currentX = x;
            
            var currentOffset = -this.currentIndex * this.slideWidth;
            var newOffset = currentOffset + diff;
            this.slidesContainer.style.transform = `translateX(${newOffset}px)`;
        };
        
        // 触摸结束处理
        this.handleTouchEnd = function() {
            if (!this.isDragging || this.isAnimating) return;
            this.isDragging = false;
            
            var diff = this.startX - this.currentX;
            if (Math.abs(diff) > this.slideWidth * 0.2) {
                if (diff > 0) {
                    this.nextSlide();
                } else {
                    this.prevSlide();
                }
            } else {
                this.updatePosition();
            }
            
            this.startAutoPlay();
        };
        
        // 窗口大小变化处理
        this.handleResize = function() {
            this.updateLayout();
        };
    }

    // 初始化
    if (!doc.addEventListener) return;
    win.addEventListener(resizeEvt, recalc, false);
    doc.addEventListener('DOMContentLoaded', function() {
        recalc();
        var carousel = new Carousel();
        carousel.init();
    }, false);
})(document, window);
</script>
    <script>
(function(doc, win) {
    // 响应式根元素计算
    var docEl = doc.documentElement,
        resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
        carouselInitialized = false,
        carouselState = {
            bottomBox: null,
            contents: null,
            contentWidth: 0,
            currentIndex: 0,
            intervalTime: 2000,
            autoPlayInterval: null,
            isAnimating: false
        };

    function recalc() {
        var clientWidth = docEl.clientWidth;
        if (!clientWidth) return;
        docEl.style.fontSize = 40 * (clientWidth / 750) + 'px';
        
        if (carouselInitialized) {
            updateCarouselLayout();
        } else {
            initCarousel();
        }
    }

    function initCarousel() {
        carouselState.bottomBox = document.querySelector('.bottom-box');
        carouselState.contents = document.querySelectorAll('.bottom-content');
        
        // 克隆第一个元素并添加到末尾
        var firstClone = carouselState.contents[0].cloneNode(true);
        carouselState.bottomBox.appendChild(firstClone);
        carouselState.contents = document.querySelectorAll('.bottom-content');
        
        updateCarouselLayout();
        startAutoPlay();
        
        carouselInitialized = true;
    }

    function updateCarouselLayout() {
        // 获取当前rem对应的px值
        var remInPx = parseFloat(getComputedStyle(document.documentElement).fontSize);
        
        // 计算内容宽度 (18.75rem)
        carouselState.contentWidth = 18.75 * remInPx;
        
        // 设置容器宽度（包括克隆元素）
        carouselState.bottomBox.style.width = `${carouselState.contents.length * carouselState.contentWidth}px`;
        
        // 设置每个内容的宽度
        carouselState.contents.forEach(content => {
            content.style.width = `${carouselState.contentWidth}px`;
        });
        
        // 更新位置
        updateCarouselPosition();
    }

    function updateCarouselPosition() {
        if (carouselState.isAnimating) return;
        
        carouselState.bottomBox.style.transition = 'transform 0.5s ease';
        carouselState.bottomBox.style.transform = `translateX(${-carouselState.currentIndex * carouselState.contentWidth}px)`;
    }

    function seamlessReset() {
        carouselState.isAnimating = true;
        
        // 禁用过渡效果
        carouselState.bottomBox.style.transition = 'none';
        carouselState.currentIndex = 0;
        carouselState.bottomBox.style.transform = `translateX(0)`;
        
        // 强制重绘
        carouselState.bottomBox.offsetHeight;
        
        // 恢复过渡效果
        carouselState.bottomBox.style.transition = 'transform 0.5s ease';
        carouselState.isAnimating = false;
    }

    function nextSlide() {
        if (carouselState.isAnimating) return;
        
        carouselState.currentIndex++;
        
        if (carouselState.currentIndex === carouselState.contents.length - 1) {
            // 正常滑动到克隆的第一个元素
            updateCarouselPosition();
            
            // 滑动完成后立即无动画重置
            setTimeout(seamlessReset, 500);
        } else {
            updateCarouselPosition();
        }
    }

    function startAutoPlay() {
        stopAutoPlay();
        carouselState.autoPlayInterval = setInterval(nextSlide, carouselState.intervalTime);
    }

    function stopAutoPlay() {
        if (carouselState.autoPlayInterval) {
            clearInterval(carouselState.autoPlayInterval);
        }
    }

    // 初始化
    if (!doc.addEventListener) return;
    win.addEventListener(resizeEvt, recalc, false);
    doc.addEventListener('DOMContentLoaded', recalc, false);
})(document, window);
</script>
</body>
</html>